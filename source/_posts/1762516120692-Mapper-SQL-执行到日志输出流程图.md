---
title: 📝 Mapper SQL 执行到日志输出流程图
category: Mybatis
tags: [log, mapper, 流程图]
date: 2025-11-08T16:39:54.463Z
---

```mermaid
flowchart TD
    A[调用 Mapper 方法] --> B[MyBatis Executor<br/>核心执行器]
    B --> C[生成 SQL 语句模板<br/>(带 ? 占位符)]
    C --> D[日志打印阶段 1: Preparing<br/>==> Preparing: SELECT ... WHERE ... = ?]
    D --> E[参数绑定<br/>(将方法参数绑定到 ?)]
    E --> F[日志打印阶段 2: Parameters<br/>==> Parameters: 300000000 (String), 20250601 (String)]
    F --> G[执行 SQL<br/>(JDBC 调用 Connection → PreparedStatement → executeQuery/executeUpdate)]
    G --> H[获取执行结果<br/>- SELECT 返回结果集<br/>- UPDATE/INSERT 返回影响行数]
    H --> I[日志打印阶段 3: 执行结果<br/><== Total: 1]
    I --> J[返回 Mapper 方法结果]
```

---

## **详细步骤说明**

### 1. 调用 Mapper 方法
- 用户通过 Mapper 接口调用对应方法。

### 2. MyBatis Executor 核心执行器
- MyBatis 核心执行器负责整个 SQL 执行流程。

### 3. 生成 SQL 语句模板
- 根据 Mapper XML 或注解生成带 **`?` 占位符**的 SQL。

### 4. 日志打印阶段 1: Preparing
- 输出 SQL 模板日志：
  ```
  ==> Preparing: SELECT ... WHERE ... = ?
  ```

### 5. 参数绑定
- 将方法参数绑定到 SQL 中的 `?` 占位符。

### 6. 日志打印阶段 2: Parameters
- 输出绑定参数日志：
  ```
  ==> Parameters: 300000000 (String), 20250601 (String)
  ```

### 7. 执行 SQL
- 通过 JDBC 调用：
  - `Connection`
  - `PreparedStatement`
  - `executeQuery()` 或 `executeUpdate()`

### 8. 获取执行结果
- **SELECT** → 返回结果集
- **UPDATE/INSERT** → 返回影响行数

### 9. 日志打印阶段 3: 执行结果
- 输出执行结果日志：
  ```
  <== Total: 1
  ```

### 10. 返回 Mapper 方法结果
- 将结果返回给调用方。

---

✅ 该 Markdown 文件支持 **Mermaid 流程图渲染**，可直接用于 GitHub README 或技术文档。
