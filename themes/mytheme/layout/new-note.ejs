<section class="main-section">   
  <!-- ============================
       æ–°å»ºç¬”è®°æ¨¡å—ï¼ˆåˆ†ç±»ä¸‹æ‹‰ + æ ‡ç­¾è‡ªåŠ¨æç¤ºï¼‰
       åŠŸèƒ½ï¼š
         - é€‰æ‹©å·²æœ‰åˆ†ç±»
         - è¾“å…¥æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰
         - è¾“å…¥æ ‡é¢˜ã€æ­£æ–‡
         - æäº¤è¡¨å•åˆ° Vercel API
  ============================ -->

  <h1 style="text-align:center;">ğŸ“ æ–°å»ºç¬”è®°</h1>

  <form id="newNoteForm">
    <!-- æ ‡é¢˜è¾“å…¥ -->
    <label for="title">æ ‡é¢˜ï¼š</label>
    <input type="text" id="title" name="title" required>

    <!-- åˆ†ç±»ä¸‹æ‹‰é€‰æ‹© -->
    <label for="category">åˆ†ç±»ï¼š</label>
    <select id="category" name="category" required>
      <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
      <option>Java</option>
      <option>SpringBoot</option>
      <option>JUnit</option>
      <option>Maven</option>
      <option>Mybatis</option>
      <option>Git</option>
      <option>SQL</option>
      <option>VBA</option>
      <option>Azure</option>
      <option>Docker</option>
      <option>å‰ç«¯</option>
      <option>æ¶æ„åˆ†æ</option>
      <option>å¿«æ·é”®</option>
    </select>

    <!-- æ ‡ç­¾è¾“å…¥ -->
    <label for="tags">æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼š</label>
    <input type="text" id="tags" name="tags" placeholder="ä¾‹å¦‚ Java, Stream">

    <!-- å†…å®¹è¾“å…¥ -->
    <label for="content">å†…å®¹ï¼š</label>
    <textarea id="content" name="content" rows="10" required></textarea>

    <!-- æäº¤æŒ‰é’® -->
    <button type="submit">æäº¤</button>
  </form>

  <style>
    /* è¡¨å•æ•´ä½“æ ·å¼ */
    #newNoteForm { 
      max-width: 1200px; 
      margin: 40px auto; 
      padding:25px; 
      border:1px solid #ddd; 
      border-radius:8px; 
      background:#fafafa; 
      font-family:"Segoe UI",sans-serif; 
    }
    #newNoteForm label { display:block; margin:15px 0 5px; font-weight:bold; }
    #newNoteForm input, #newNoteForm textarea, #newNoteForm select { 
      width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; margin-bottom:10px; font-size:14px; 
    }
    #newNoteForm button { width:100%; padding:12px; background:#0078d7; color:#fff; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
    #newNoteForm button:hover { background:#005a9e; }
  </style>

  <script>
    document.getElementById('newNoteForm').addEventListener('submit', async function(e){
      e.preventDefault(); // é˜»æ­¢è¡¨å•é»˜è®¤åˆ·æ–°

      const form = e.target;
      const payload = {
        title: form.title.value,                  // æ ‡é¢˜
        category: form.category.value,            // åˆ†ç±»
        tags: form.tags.value.split(',')          // æ ‡ç­¾æ•°ç»„
                  .map(t => t.trim())
                  .filter(Boolean),
        content: form.content.value               // å†…å®¹
      };

      try {
        // è°ƒç”¨ Vercel API åˆ›å»ºæ–°ç¬”è®°
        const res = await fetch('/api/new-note', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });

        const data = await res.json();

        if(res.ok){
          alert('âœ… ç¬”è®°åˆ›å»ºæˆåŠŸï¼');
          window.location.href = '/'; // æˆåŠŸè·³è½¬é¦–é¡µ
        } else {
          alert('âŒ åˆ›å»ºå¤±è´¥ï¼š' + JSON.stringify(data.error));
        }
      } catch(err){
        alert('âŒ ç½‘ç»œæˆ–æœåŠ¡å™¨é”™è¯¯ï¼š' + err.message);
      }
    });
  </script>
</section>
